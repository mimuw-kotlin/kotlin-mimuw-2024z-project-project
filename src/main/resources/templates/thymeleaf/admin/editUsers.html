<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="UTF-8">
  <title>Edycja użytkowników</title>
  <link rel="stylesheet" type="text/css" href="./cssAdmin/styleAdmin.css">
  <script>
    function toggleTable(tableName) {
      let table = document.getElementById(tableName);
      if (table.style.display === "none") {
        table.style.display = "table";
      } else {
        table.style.display = "none";
      }
    }
  </script>
</head>

<body th:with="STUDENTS_TABLE='studentsTable', TEACHERS_TABLE='teachersTable'">

<a href="/admin/controlPanel">Powrót</a>

<p th:if="${status} == '0'" style="color: darkgreen">Zmiany zostały zapisane!</p>

<p th:if="${status} == '1'" style="color: darkred">Błędne parametry w formularzu!</p>

<h1>Edytuj Uczniów</h1>

<p th:if="${status} == '2'" style="color: darkred">Zmodyfikowałeś pole userType bądź index w formularzu ucznia, nie można go modyfikować!</p>

<button onclick=toggleTable("studentsTable")>Pokaż/Ukryj</button>

<br>

<table th:id="${STUDENTS_TABLE}">
  <thead>
  <tr>
    <th>Index</th>
    <th>Nazwa Użytkownika</th>
    <th>Klasa</th>
    <th>Aktywny</th>
  </tr>
  </thead>
  <tbody>
  <tr th:each="student : ${students}">

    <form th:action="'/admin/editUser'" method="post">
    <td><input type="text" th:name="'index'" th:value="${student.index}" readonly /></td>
    <td><input type="text" th:name="'username'" th:value="${student.username}" /></td>
    <td><input type="text" th:name="'classNbr'" th:value="${student.classNbr}" /></td>
    <td>
      <select th:name="'active'">
        <option th:value="true" th:text="'true'" th:selected="${student.active} == true"></option>
        <option th:value="false" th:text="'false'" th:selected="${student.active} == false"></option>
      </select>
    <td>
        <button type="submit">Zapisz zmiany</button>
    </td>
    <input type="hidden" th:name="'userType'" th:value="'student'" />
    </form>
  </tr>
  </tbody>
</table>

<h1>Edytuj Nauczycieli</h1>

<p th:if="${error} == '3'">Zmodyfikowałeś pole nauczyciela którego nie można modyfikować!</p>

<button onclick=toggleTable("teachersTable")>Pokaż/Ukryj</button>

<br>

  <table th:id="${TEACHERS_TABLE}">
    <thead>
    <tr>
      <th>Index</th>
      <th>Nazwa Użytkownika</th>
      <th>Klasa</th>
      <th>Typ</th>
      <th>Aktywny</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="teacher : ${teachers}">

      <form th:action="'/admin/editUser'" method="post">
      <td><input type="text" th:name="'index'" th:value="${teacher.index}" readonly /></td>
      <td><input type="text" th:name="'username'" th:value="${teacher.username}" /></td>
      <td><input type="text" th:name="'classNbr'" th:value="${teacher.classNbr}" /></td>
      <td>
        <select th:name="'userType'">
          <option th:value="'teacher'"  th:text="'teacher'" th:selected="${teacher.userType} == 'teacher'"></option>
          <option th:value="'headmaster'" th:text="'headmaster'" th:selected="${teacher.userType} == 'headmaster'"></option>
        </select>
      </td>

      <td>
        <select th:name="'active'">
          <option th:value="true" th:text="'true'" th:selected="${teacher.active} == true"></option>
          <option th:value="false" th:text="'false'" th:selected="${teacher.active} == false"></option>
        </select>
      </td>
      <td>
        <button type="submit">Zapisz zmiany</button>
      </td>
        </form>
    </tr>
    </tbody>
  </table>

</body>
</html>
